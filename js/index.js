let listProducts = [
    {
        name: "DOLLIE PIGMENT DYED TEE",
        price: 59,
        img: "./image/tee/tee1.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee1.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee1-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee1-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "STOCK BOX TEE",
        price: 49,
        img: "./image/tee/tee2.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee2.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee2-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee2-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "TRIBE STACK TEE",
        price: 49,
        img: "./image/tee/tee3.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee3.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee3-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee3-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "SARA TEE",
        price: 59,
        img: "./image/tee/tee4.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee4.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee4-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee4-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "DOMINOES TEE",
        price: 49,
        img: "./image/tee/tee6.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee6.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee6-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee6-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "RACECAR TEE",
        price: 59,
        img: "./image/tee/tee7.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee7.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee7-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee7-3.webp",
                stock: 11
            }
        ]

    },
    {
        name: "ZIZZA TEE",
        price: 59,
        img: "./image/tee/tee8.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee8.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee8-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee8-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "ONTHE TEE",
        price: 49,
        img: "./image/tee/tee9.webp",
        nameList: "TEE",
        options: [
            {
                icon: "./image/tee/tee9.webp",
                stock: 5
            },
            {

                icon: "./image/tee/tee9-2.webp",
                stock: 9
            },
            {
                icon: "./image/tee/tee9-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "SARA ZIP HOODIE",
        price: 99,
        img: "./image/sweats/sw1.webp",
        nameList: "SWT",
        options: [
            {
                icon: "./image/sweats/sw1.webp",
                stock: 5
            },
            {

                icon: "./image/sweats/sw1-2.webp",
                stock: 9
            },
            {
                icon: "./image/sweats/sw1-3.webp",
                stock: 11
            }
        ]
    },
    {
        name: "ZIP COLOR HOODIE",
        price: 109,
        img: "./image/sweats/sw5.webp",
        nameList: "SWT",
        options: [
            {
                icon: "./image/sweats/sw5.webp",
                stock: 5
            },
            {

                icon: "./image/sweats/sw5-2.webp",
                stock: 9
            },
            {
                icon: "./image/sweats/sw5-3.webp",
                stock: 11
            }
        ]
    },
    {

        name: "SKULL CREST ZIP HOODIE",
        price: 99,
        img: "./image/sweats/sw2.webp",
        nameList: "SWT",
        options: [
            {
                icon: "./image/sweats/sw2.webp",
                stock: 5
            },
            {

                icon: "./image/sweats/sw2-2.webp",
                stock: 9
            },
            {
                icon: "./image/sweats/sw5-3.webp",
                stock: 11
            }
        ]
    },
    {

        name: "OUR DYED HOODIE",
        price: 89,
        img: "./image/sweats/sw3.webp",
        nameList: "SWT",
        options: [
            {
                icon: "./image/sweats/sw3.webp",
                stock: 5
            },
            {

                icon: "./image/sweats/sw3.webp",
                stock: 9
            },
            {
                icon: "./image/sweats/sw3-2.webp",
                stock: 11
            }
        ]
    },
    {

        name: "OVERDYED STOCK LOGO HOODIE",
        price: 99,
        img: "./image/sweats/sw4.webp",
        nameList: "SWT",
        options: [
            {
                icon: "./image/sweats/sw4.webp",
                stock: 5
            },
            {

                icon: "./image/sweats/sw4-2.webp",
                stock: 9
            },
            {
                icon: "./image/sweats/sw4-3.webp",
                stock: 11
            }
        ]
    },
    {

        name: "NEWCOOL STOCK LOGO HOODIE",
        price: 99,
        img: "./image/sweats/sw6.webp",
        nameList: "SWT",
        options: [
            {
                icon: "./image/sweats/sw6.webp",
                stock: 5
            },
            {

                icon: "./image/sweats/sw6-2.webp",
                stock: 9
            },
            {
                icon: "./image/sweats/sw6-3.webp",
                stock: 11
            }
        ]
    },
    {

        name: "BOXY STRIPED SS SHIRT",
        price: 89,
        img: "./image/top&shirts/ts1.webp",
        nameList: "TS",
        options: [
            {
                icon: "./image/top&shirts/ts1.webp",
                stock: 5
            },
            {

                icon: "./image/top&shirts/ts1-2.webp",
                stock: 9
            },

        ]
    },
    {

        name: "TOP SHIRTS BLACK",
        price: 89,
        img: "./image/top&shirts/ts2.webp",
        nameList: "TS",
        options: [
            {
                icon: "./image/top&shirts/ts2.webp",
                stock: 5
            }
        ]
    },
    {
        name: "WRINKLY GINGHAM SS SHIRT",
        price: 99,
        img: "./image/top&shirts/st3.webp",
        nameList: "TS",
        options: [
            {
                icon: "./image/top&shirts/st3.webp",
                stock: 5
            },
            {

                icon: "./image/top&shirts/st3-2.webp",
                stock: 9
            }
        ]
    },
    {
        name: "4X4 MESH FOOTBALL JERSEY",
        price: 109,
        img: "./image/top&shirts/ts4.webp",
        nameList: "TS",
        options: [
            {
                icon: "./image/top&shirts/ts4.webp",
                stock: 5
            },
            {

                icon: "./image/top&shirts/ts4-2.webp",
                stock: 9
            }
        ]
    },
    {
        name: "OUR LEGACY WORK SHOP BORROWED SHIRT",
        price: 109,
        img: "./image/top&shirts/ts5.webp",
        nameList: "TS",
        options: [
            {
                icon: "./image/top&shirts/ts5.webp",
                stock: 5
            },
            {

                icon: "./image/top&shirts/ts5-2.webp",
                stock: 9
            },
            {

                icon: "./image/top&shirts/ts5-3.webp",
                stock: 9
            }
        ]
    },
    {
        name: "OUR LEGACY WORK SHOP RANCH SHIRT",
        price: 109,
        img: "./image/top&shirts/ts6.webp",
        nameList: "TS",
        options: [
            {
                icon: "./image/top&shirts/ts5.webp",
                stock: 5
            }
        ]
    },
    {
        name: "RIPSTOP CARGO BEACH PANTM",
        price: 199,
        img: "./image/bottom/bt6.webp",
        nameList: "BT",
        options: [
            {
                icon: "./image/bottom/bt6.webp",
                stock: 5
            },
            {

                icon: "./image/bottom/bt6-2.webp",
                stock: 9
            },
            {

                icon: "./image/bottom/bt6-3.webp",
                stock: 9
            }
        ]
    },
    {

        name: "DOLLIE PIGMENT DYED BOTTOM",
        price: 199,
        img: "./image/bottom/bt2.webp",
        nameList: "BT",
        options: [
            {
                icon: "./image/bottom/bt2.webp",
                stock: 5
            },
            {

                icon: "./image/bottom/bt2-2.webp",
                stock: 9
            }
        ]
    },
    {
        name: "OUR LEGACY WORK SHOP REDUCED TROUSER",
        price: 199,
        img: "./image/bottom/bt3.webp",
        nameList: "BT",
        options: [
            {
                icon: "./image/bottom/bt3.webp",
                stock: 5
            },
            {

                icon: "./image/bottom/bt3-2.webp",
                stock: 9
            }
        ]
    },
    {
        name: "DOLLIE BOTTOM",
        price: 89,
        img: "./image/bottom/bt4.webp",
        nameList: "BT",
        options: [
            {
                icon: "./image/bottom/bt4.webp",
                stock: 5
            }

        ]

    },
    {
        name: "DOLLIE PIG BOTTOM",
        price: 99,
        img: "./image/bottom/bt5.webp",
        nameList: "BT",
        options: [
            {
                icon: "./image/bottom/bt5.webp",
                stock: 5
            }
        ]

    },
    {
        name: "OUR LEGACY WORK SHOP WATER SHORT",
        price: 99,
        img: "./image/bottom/bt1.webp",
        nameList: "BT",
        options: [
            {
                icon: "./image/bottom/bt1.webp",
                stock: 5
            },
            {

                icon: "./image/bottom/bt1-2.webp",
                stock: 9
            },
            {

                icon: "./image/bottom/bt1-3.webp",
                stock: 9
            }
        ]
    },

    {
        name: "DOLLIE MENT OUTERWEAR",
        price: 299,
        img: "./image/outwear/ow1.webp",
        nameList: "OT",
        options: [
            {
                icon: "./image/outwear/ow1.webp",
                stock: 5
            },
            {

                icon: "./image/outwear/ow1-2.webp",
                stock: 9
            }

        ]

    },
    {
        name: "DOLLIE PIGT OUTERWEAR",
        price: 299,
        img: "./image/outwear/ow2.webp",
        nameList: "OT",
        options: [
            {
                icon: "./image/outwear/ow2.webp",
                stock: 5
            },
            {
                icon:"./image/outwear/ow2-2.webp",
                stock: 9
            }

        ]
    },
    {
        name: "DOLLIE PIGMENT OUTERWEAR",
        price: 299,
        img: "./image/outwear/ow3.webp",
        nameList: "OT",
        options: [
            {
                icon:  "./image/outwear/ow3.webp",
                stock: 5
            },
            {
                icon:"./image/outwear/ow3-2.webp",
                stock: 9
            },
            {
                icon:  "./image/outwear/ow3-3.webp",
                stock: 9
            }
        ]
    },
    {
        name: "DOLLIE PIGMENT OUTERWEAR",
        price: 249,
        img: "./image/outwear/ow4.webp",
        nameList: "OT",
        options: [
            {
                icon:   "./image/outwear/ow4.webp",
                stock: 5
            },
            {
                icon: "./image/outwear/ow4-2.webp",
                stock: 9
            },
            {
                icon:  "./image/outwear/ow4-3.webp",
                stock: 9
            }
        ] 
    },
    {
        name: "OVERDYED ZIP WORK JACKET",
        price: 249,
        img: "./image/outwear/ow5-3.webp",
        nameList: "OT",
        options: [
            {
                icon:    "./image/outwear/ow5.webp",
                stock: 5
            },
            {
                icon:   "./image/outwear/ow5-2.webp",
                stock: 9
            },
            {
                icon:   "./image/outwear/ow5-3.webp",
                stock: 9
            }
        ] 
        
    },
    {
        name: "DOLLIE PIGMENT OUTERWEAR",
        price: 299,
        img: "./image/outwear/ow6.webp",
        nameList: "OT",
        options: [
            {
                icon:    "./image/outwear/ow6.webp",
                stock: 5
            },
            {
                icon:   "./image/outwear/ot6-2.webp",
                stock: 9
            }
        ] 
    },
    {
        name: "STÜSSY & NIKE BENASSI SLIDE",
        price: 45,
        img: "./image/acces/ac1.webp",
        nameList: "AC",
        options: [
            {
                icon:      "./image/acces/ac1.webp",
                stock: 5
            },
            {
                icon:    "./image/acces/ac1-2.webp",
                stock: 9
            }
        ] 
    },
    {
        name: "LEATHER OVERLAY BELT",
        price: 45,
        img: "./image/acces/ac2.webp",
        nameList: "AC",
        options: [
            {
                icon:      "./image/acces/ac2.webp",
                stock: 5
            },
            {
                icon:    "./image/acces/ac2-2.webp",
                stock: 9
            }
        ] 
    },
    {
        name: "PEACE TIE CLIP",
        price: 45,
        img: "./image/acces/ac3.webp",
        nameList: "AC",
        options: [
            {
                icon:     "./image/acces/ac3.webp",
                stock: 5
            },
            {
                icon: "./image/acces/ac3-2.webp",
                stock: 9
            },
            {
                icon:  "./image/acces/ac3-3.webp",
                stock: 9
            }
        ] 
       
    },
    {
        name: "WORK GLOVES",
        price: 45,
        img: "./image/acces/ac4.webp",
        nameList: "AC",
        options: [
            {
                icon: "./image/acces/ac4.webp",
                stock: 5
            },
            {
                icon:    "./image/acces/ac4-2.webp",
                stock: 9
            },
            {
                icon: "./image/acces/ac4-3.webp",
                stock: 9
            }
        ] 
    },
    {
        name: "WORK GLOVES",
        price: 45,
        img: "./image/acces/ac5.webp",
        nameList: "AC",
        options: [
            {
                icon:  "./image/acces/ac5.webp",
                stock: 5
            },
            {
                icon:   "./image/acces/ac5-2.webp",
                stock: 9
            }
        ]
    },
    {
        name: "WORK GLOVES COLORMIX",
        price: 45,
        img: "./image/acces/ac6.webp",
        nameList: "AC",
        options: [
            {
                icon:    "./image/acces/ac6.webp",
                stock: 5,
            },
            {
                icon:   "./image/acces/ac6-2.webp",
                stock: 9
            }
        ]
    }
]
// hàm sinh id
function uuid() {
    return new Date().getMilliseconds() + Math.floor(Math.random() * 9999)
}

const USDollar = new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: 'USD',
})

// gắn id cho product và các options
for (let i in listProducts) {
    listProducts[i].id = uuid();
    for (let j in listProducts[i].options) {
        listProducts[i].options[j].id = uuid() + j;
    }
}

// nếu như chưa có danh sách hàng hóa trong local thì thêm vào
if (!localStorage.getItem('listProducts')) {
    localStorage.setItem("listProducts", JSON.stringify(listProducts))
}


//function banner ảnh tự lướt
let listBanner = document.querySelectorAll(".banner img")
console.log(listBanner);
let indexBanner = 0;
function nextBanner() {
    listBanner[indexBanner].style.display = "none";
    indexBanner = (indexBanner + 1) % listBanner.length
    listBanner[indexBanner].style.display = "block";
}
setInterval(nextBanner, 1000)
let currentPage = 1;
let toTalItemPage = 6; // Số ảnh hiện thị trong 1 trang
let start;
let end;

function showCurrentPage(page) {
    start = (page - 1) * toTalItemPage;
    end = page * toTalItemPage
}
showCurrentPage(currentPage)
// function kiểm tra người đăng nhập có phải là admin hay không. 
// nếu là admin thì hiển thị nút admin để truy cập vào kho hàng
function checkAdmin() {
    let checkAdmin = localStorage.getItem("checkLogin")


    if (checkAdmin !== 2533) {
        document.querySelector(".admin-button").style.display = "none";
        return;
    }
}
checkAdmin()


function showListPage(a) {
    let listProducts = JSON.parse(localStorage.getItem("listProducts"))
    let result = "";
    for (let i = 0; i < Math.ceil(listProducts.length / toTalItemPage); i++) {
        result +=
            `
            <li onclick="pageNow(${i})" class="itemPage">${i + 1}</li>
        `
    }
    document.getElementById("listShowPage").innerHTML = result;
    document.getElementsByClassName("itemPage")[a].classList.add("active-page")
    showArrowCurrent(currentPage)
}

//function chuyển qua trang tiếp theo 
function increasePage() {
    currentPage++;
    let listProducts = JSON.parse(localStorage.getItem("listProducts"))

    if (currentPage == Math.ceil(listProducts.length / toTalItemPage) + 1) {
        currentPage = Math.ceil(listProducts.length / toTalItemPage)
    }
    let listItemPage = document.getElementsByClassName("itemPage")
    console.log(listItemPage.length);
    for (let i = 0; i < listItemPage.length; i++) {

        if (i == currentPage - 1) {

            listItemPage[i].classList.add("active-page");

        } else {

            listItemPage[i].classList.remove("active-page");
        }

    }
    showCurrentPage(currentPage);
    renderProducts(JSON.parse(localStorage.getItem("listProducts")));
    showListPage(currentPage - 1)
}


function decreasePage() {
    console.log("decrease");
    let listItemPage = document.getElementsByClassName("itemPage");
    let listProducts = JSON.parse(localStorage.getItem("listProducts"))
    currentPage--;
    if (currentPage == 0) {
        currentPage = 1
    }
    for (let i = 0; i < listItemPage.length; i++) {
        if (i == currentPage - 1) {
            listItemPage[i].classList.add("active-page");
        } else {
            listItemPage[i].classList.remove("active-page");
        }

    }
    showCurrentPage(currentPage);
    renderProducts(JSON.parse(localStorage.getItem("listProducts")));
    showListPage(currentPage - 1)
}
//function click vào page now thì khi click tiếp chuyển trang tới
function pageNow(pageNow) {
    console.log(currentPage);
    console.log(pageNow);
    let listItemPage = document.getElementsByClassName("itemPage")
    for (let i = 0; i < listItemPage.length; i++) {
        if (i == pageNow) {
            listItemPage[i].classList.add("active-page");
        } else {
            listItemPage[i].classList.remove("active-page");
        }

    }
    showCurrentPage(pageNow + 1);

    renderProducts(JSON.parse(localStorage.getItem("listProducts")));
    showListPage(pageNow)
    currentPage = pageNow + 1;
}

function showArrowCurrent(a) {
    console.log(a);
    if (a < 2) {
        document.querySelector(".material-symbols-outlined").style.display = "none"
        return;
    } else if (a > 1 && a != 6) {
        document.querySelector(".material-symbols-outlined").style.display = "block"
        return;
    } else if (a == 6) {
        document.querySelector(".symbolsRight").style.display = "none"
    }
}


function renderProducts(param) {
    let result = ""
    for (let i = 0; i < param.length; i++) {
        if (i >= start && i < end) {
            result +=
                `
        <div class="item" > 
            <div class="item-img">
                 <img src="${param[i].img}" alt="" onclick="renderProductItem('${param[i].id}')">
            </div>
            <div class="item-detail">
                 <p class = "item-name">Name: ${param[i].name} </p>
                <p class = "item-detail-price" >Price : ${USDollar.format(param[i].price)}</p>
             </div>

        </div>
          `
        }
    }
    document.querySelector(".product").innerHTML =
        `
   <div class="main">  ${result} </div>
   
        <div class="list-page">
            <span onclick="decreasePage()" class="material-symbols-outlined">
                navigate_before
            </span>
            <ul id="listShowPage">
            
            </ul>
            <span onclick="increasePage()" class="material-symbols-outlined symbolsRight">
                chevron_right
            </span>
        </div>

    `
        ;
    showListPage(0)
}

function loginNext() {
    window.location.href = "../html/login.html";

}
function registerNext() {
    window.location.href = "../html/register.html";
}

function addCart(idProduct) {
    let checkIsLogin = localStorage.getItem("checkLogin");
    if (checkIsLogin == null) {
        alert("Chưa đăng nhập - không thể thêm sản phẩm vào giỏ hàng");
        return;
    }
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    console.log(listProducts)
    let listUser = JSON.parse(localStorage.getItem("listUser"));
    console.log(listUser)
    //khi đã có được list user thì mình dựa vào iduser
    // lấy ra giỏ hàng của user
    for (let i = 0; i < listUser.length; i++) {
        if (listUser[i].idUser == checkIsLogin) {
            let cartUser = listUser[i].cartUser;
            console.log(cartUser);
            for (let j = 0; j < cartUser.length; j++) {
                if (cartUser[j].img === document.getElementById("main-image").src) {
                    cartUser[j].quantity += 1;
                    localStorage.setItem("listUser", JSON.stringify(listUser));
                    showTotalCartProduct()
                    return;
                }
            }

            for (let j = 0; j < listProducts.length; j++) {

                if (listProducts[j].id == idProduct) {
                    let item = {
                        img: document.getElementById("main-image").src,
                        name: listProducts[j].name,
                        price: listProducts[j].price,
                        quantity: 1
                    }
                    cartUser.push(item);
                    localStorage.setItem("listUser", JSON.stringify(listUser));
                    showTotalCartProduct();
                    return;
                }

            }
        }
    }

}

function showTotalCartProduct() {

    let listUser = JSON.parse(localStorage.getItem("listUser"));
    if (!listUser) {
        return 0
    }
    let checkIsLogin = localStorage.getItem("checkLogin");

    let user = listUser.find((item) => {
        return item.idUser == checkIsLogin
    })

    let cartUser = (user.cartUser);

    let total = cartUser.reduce((total1, curreValue) => {
        return total1 += curreValue.quantity;
    }, 0)

    // localStorage.setItem("cartTotal", user.cartUser.length);
    document.getElementById("totalCoutnProduct").innerHTML = `${total}`;
}

if (checkLogin()) {
    showTotalCartProduct()
}


function renderTee() {
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    console.log(2222);
    let listRender = [];
    for (let i = 0; i < listProducts.length; i++) {
        if (listProducts[i].nameList.includes("TEE")) {
            listRender.push(listProducts[i])
        }
    }
    console.log(listRender);
    start = 0;
    end = 6;
    renderProducts(listRender)
    showListPage(listRender.length)

}
function renderSW() {
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    console.log(333);
    let listRender = [];
    for (let i = 0; i < listProducts.length; i++) {
        if (listProducts[i].nameList.includes("SW")) {
            listRender.push(listProducts[i])
        }

    }
    console.log(listRender);
    start = 0;
    end = 6;
    renderProducts(listRender)
}

function renderTS() {
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    console.log(333);
    let listRender = [];
    for (let i = 0; i < listProducts.length; i++) {
        if (listProducts[i].nameList.includes("TS")) {
            listRender.push(listProducts[i])
        }

    }
    start = 0;
    end = 6;
    renderProducts(listRender)
}


function renderBT() {
    console.log(333);
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    let listRender = [];
    for (let i = 0; i < listProducts.length; i++) {
        if (listProducts[i].nameList.includes("BT")) {
            listRender.push(listProducts[i])
        }

    }
    start = 0;
    end = 6;
    renderProducts(listRender)
}
function renderOT() {
    console.log(333);
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    let listRender = [];
    for (let i = 0; i < listProducts.length; i++) {
        if (listProducts[i].nameList.includes("OT")) {
            listRender.push(listProducts[i])
        }

    }
    start = 0;
    end = 6;
    renderProducts(listRender)
}
function renderAC() {
    console.log(333);
    let listProducts = JSON.parse(localStorage.getItem("listProducts"));
    let listRender = [];
    for (let i = 0; i < listProducts.length; i++) {
        if (listProducts[i].nameList.includes("AC")) {
            listRender.push(listProducts[i])
        }

    }
    start = 0;
    end = 6;
    renderProducts(listRender)
}
function checklogout() {
    let confirmLogout = confirm("Ban co muon thoat khong?")
    if (confirmLogout) {
        localStorage.removeItem("checkLogin");
        document.getElementsByClassName("logout")[0].style.display = "none";
        document.getElementById("totalCoutnProduct").innerHTML = 0;
        document.getElementsByClassName("login")[0].style.display = "block";
        document.getElementsByClassName("register")[0].style.display = "block";

    }
}
function checkLogin() {
    let getLogin = localStorage.getItem("checkLogin");
    if (getLogin == null) {
        document.getElementsByClassName("logout")[0].style.display = "none";
        document.getElementsByClassName("login")[0].style.display = "block";
        document.getElementsByClassName("register")[0].style.display = "block";
        return false;
    } else {
        document.getElementsByClassName("login")[0].style.display = "none";
        document.getElementsByClassName("register")[0].style.display = "none";
        return true;
    }
};
if (checkLogin()) {
    document.getElementsByClassName("logout")[0].style.display = "block";
};

function renderProductItem(idProduct) {
    console.log(idProduct);
    let listProductLocal = JSON.parse(localStorage.getItem("listProducts"));
    let productItem = listProductLocal.find((item) => {
        return item.id == idProduct
    })
    console.log(productItem);
    let result = `
    <div class="productContainer">
        <div class="item-left">
            <img id="main-image" src="${productItem.img}" alt="">
        </div>
        <div class="item-right">
            <div class="item-right-detail">
                <h2>${productItem.name}</h2>
                <span>Price : ${USDollar.format(productItem.price)}</span>
            <div class="color">
                <span>Select Color:</span> <br>
                
            </div>
        <span class="shipping">Free shipping in US for orders over $200 USD</span> <br>
        <span>Stock Available : ${productItem.stock} items</span>
        <p><i onclick=addCart('${productItem.id}') class="fa-solid fa-cart-shopping minicart"></i></p>
    </div>
    </div>
 </div>
    `
    document.querySelector(".product").innerHTML = result;

    let color = document.querySelector(".color");
    let resultColor = "";
    for (let i = 0; i < productItem.color.length; i++) {
        resultColor += `
        <img onclick="renderSelectColor(this)" src="${productItem.color[i]}" alt="">
        `
    }
    color.innerHTML = `<span> Select Color:</span> <br> ${resultColor}`;
};

function searchProduct() {
    // document.querySelector(".search-products").classList.remove("show");
    document.querySelector(".search-products").style.display = "grid";
    console.log("111111")
    let listProducts = JSON.parse(localStorage.getItem("listProducts"))
    console.log(listProducts);
    let valueSearch = document.getElementById("valueSearch").value;
    let userSearch = listProducts.filter(item => {
        return item.name.toUpperCase().includes(valueSearch.toUpperCase())
    })
    console.log(userSearch);
    renderSearchProducts(userSearch);

};

// Hàm hiển thị sản phẩm người dùng muốn tìm kiếm

function renderSearchProducts(params) {
    let result = "";
    for (let i = 0; i < params.length; i++) {
        result += `
        <div class="search-product-item" onclick="renderProductItem('${params[i].id}')">
            <div class="search-product-item-img">
                <img src="${params[i].img}" alt="">
            </div>
            <div class="search-product-item-info">
                <h5>${params[i].name}</h5>
                <p>${USDollar.format(params[i].price)}</p>
            </div>
        </div>
        `
    }
    document.querySelector(".search-products").innerHTML = result;
    document.querySelector(".product").style.opacity = 0.5;
}

// Hàm xử lí khi người dùng xóa hết dữ liệu trong ô tìm kiếm thì ẩn vùng hiển thị sản phẩm đã tìm kiếm
document.querySelector(".search-product").addEventListener("input", handleInputclear);


function handleInputclear() {
    let valueSearch = document.getElementById("valueSearch").value;

    if (valueSearch === "") {
        document.querySelector(".search-products").innerHTML = "";
        document.querySelector(".search-products").style.display = "none";
        document.querySelector(".product").style.opacity = 1;
    }
}

// Hàm xử lí khi click vào vùng khác thì ẩn vùng hiển thị sản phẩm đã tìm kiếm

document.addEventListener("click", handleClickOutside);

function handleClickOutside(event) {
    let searchProduct = document.querySelector(".search-products");
    let target = event.target;

    if (!searchProduct.contains(target)) {
        document.querySelector(".search-products").innerHTML = "";
        // document.querySelector(".search-products").classList.add("show");
        document.querySelector(".product").style.opacity = 1;
    }
}

//function de nguoi dung chon mau 

function renderSelectColor(param) {
    console.log(param);
    document.querySelector("#main-image").src = `${param.src}`;
}
console.log(document.querySelector("#cart-product"));
document.querySelector("#cart-product").addEventListener("click", () => {
    console.log(21111);
    window.location.href = "../html/cart.html";

})
